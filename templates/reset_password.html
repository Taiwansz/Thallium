{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        <div class="content-card mt-5">
            <h1 class="text-center mb-4">Redefinir Senha</h1>
            <form method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <div class="form-group">
                    <label for="code">Código de Verificação</label>
                    <input type="text" class="form-control text-center" id="code" name="code" placeholder="000000" maxlength="6" required>
                </div>
                <div class="form-group">
                    <label for="password">Nova Senha</label>
                    <input type="password" class="form-control" id="password" name="password" required>
                    <div class="progress mt-2" style="height: 5px;">
                        <div class="progress-bar" id="strength-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <small id="password-strength-text" class="form-text text-muted"></small>
                </div>
                <div class="form-group">
                    <label for="confirm_password">Confirmar Nova Senha</label>
                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Salvar Nova Senha</button>
            </form>
        </div>
    </div>
</div>

<script>
    const passwordInput = document.getElementById('password');
    const strengthBar = document.getElementById('strength-bar');
    const strengthText = document.getElementById('password-strength-text');

    passwordInput.addEventListener('input', function() {
        const val = passwordInput.value;
        let strength = 0;
        if(val.length >= 6) strength += 20;
        if(val.match(/[a-z]+/)) strength += 20;
        if(val.match(/[A-Z]+/)) strength += 20;
        if(val.match(/[0-9]+/)) strength += 20;
        if(val.match(/[$@#&!]+/)) strength += 20;

        strengthBar.style.width = strength + '%';
        if(strength < 40) {
            strengthBar.className = 'progress-bar bg-danger';
            strengthText.innerText = 'Fraca';
        } else if(strength < 80) {
            strengthBar.className = 'progress-bar bg-warning';
            strengthText.innerText = 'Média';
        } else {
            strengthBar.className = 'progress-bar bg-success';
            strengthText.innerText = 'Forte';
        }
    });
</script>
{% endblock %}
